# 分类扩展与自定义字段（进阶/可选）

本模块更偏“系统管理员/资产管理员”使用，用于解决一个问题：

> 不同资产分类需要记录的字段不一样（例如：电脑要 CPU/内存/硬盘；车辆要车牌/排量；计量器具要校准周期），如何不改代码就能扩展？

系统当前提供了两类“扩展能力”（但是否在业务页面中真正启用，取决于你们是否已做联动开发/配置）：

## 1) 分类扩展信息（assetCategoryProfile）

对应数据：
- `am_asset_category_profile`

主要用途：
- 给某个“资产分类”配置默认的折旧参数（折旧方法/折旧期/残值率）
- 以及分类级别的扩展配置（ExtJson）

典型用法（建议）：
- 当创建资产或创建折旧配置时，若资产选择了分类，则自动带出该分类的默认折旧参数

现状提示：
- 如果你在新增资产/折旧配置时看不到自动带出，说明当前版本可能还没有做“读取分类配置并联动”的逻辑，需要后续接入。

## 2) 分类扩展字段定义（assetAttrDef）+ 资产扩展字段（ExtJson）

对应数据：
- `am_asset_attr_def`：定义“某分类有哪些扩展字段”
- `am_asset.ExtJson`：资产实例层面存放扩展字段值（JSON）

字段定义里常见的配置：
- FieldKey：字段唯一 key（例如 cpu、ram、licenseKey）
- FieldName：字段显示名称（例如 CPU、内存、授权码）
- DataType：string/number/date/bool/select/multi-select 等
- OptionsJson：select 的选项、校验规则等
- IsRequired：是否必填
- IsEnabled：是否启用
- Sort：排序

典型用法（建议）：
- 在“新增/编辑资产”页面，选择分类后，动态渲染该分类的扩展字段表单
- 保存时，把扩展字段值写入资产的 ExtJson
- 在“资产详情”页展示 ExtJson 的扩展字段（按 FieldKey→FieldName 映射）
- 在“资产列表/导出”支持按扩展字段筛选/导出（可选）

现状提示：
- 如果你目前在资产新增/详情页看不到扩展字段，说明当前版本可能尚未启用动态表单渲染，字段定义先作为“配置能力预留”存在。

## 3) 什么时候值得启用它

适合：
- 资产种类多、字段差异大
- 业务要求经常新增字段，但又不希望每次都改代码/改表结构

不太适合：
- 资产类型很少且字段固定
- 强依赖结构化查询/统计（ExtJson 会增加统计复杂度，除非你们有额外的索引策略）

